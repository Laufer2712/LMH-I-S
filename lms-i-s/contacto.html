<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Contacto - LMH I&S</title>
    <link rel="stylesheet" href="css/header-footer.css" />
    <link rel="stylesheet" href="css/style.css" />
    <script defer src="js/main.js"></script>
  </head>
  <body>
    <!-- HEADER -->
    <div id="header"></div>

    <!-- CONTACTO -->
    <section id="contact" class="contact section animate-up">
      <div class="container">
        <h2>📩 Contáctanos</h2>
        <form class="contact-form" id="contactForm">
          <input type="text" name="nombre" placeholder="Tu nombre" required />
          <input type="email" name="email" placeholder="Tu correo" required />
          <textarea
            name="mensaje"
            rows="5"
            placeholder="Tu mensaje..."
            required
          ></textarea>
          <button type="submit" class="btn-primary">Enviar</button>
        </form>
      </div>
    </section>

    <!-- FOOTER -->
    <div id="footer"></div>

    <script>
      // Cargar header y footer
      async function loadInclude(id, file) {
        try {
          const res = await fetch(file);
          const content = await res.text();
          document.getElementById(id).innerHTML = content;

          if (id === "header") initMenu();
          if (id === "footer") {
            const yearSpan = document.getElementById("year");
            if (yearSpan) yearSpan.textContent = new Date().getFullYear();
          }
        } catch (err) {
          console.error(`Error al cargar ${file}:`, err);
        }
      }

      loadInclude("header", "includes/header.html");
      loadInclude("footer", "includes/footer.html");

      // Formulario contacto
      document
        .getElementById("contactForm")
        .addEventListener("submit", async function (e) {
          e.preventDefault();

          const formData = {
            nombre: this.nombre.value,
            email: this.email.value,
            mensaje: this.mensaje.value,
          };

          try {
            const res = await fetch("contacto.php", {
              method: "POST",
              body: JSON.stringify(formData),
            });

            const text = await res.text();
            alert(text);
            if (res.status === 200) this.reset();
          } catch (err) {
            alert("❌ Error al enviar el mensaje, intenta de nuevo.");
            console.error(err);
          }
        });

      // Animaciones scroll
      function animateOnScroll() {
        const elements = document.querySelectorAll(".animate-up");
        const triggerBottom = window.innerHeight * 0.85;
        elements.forEach((el) => {
          const elementTop = el.getBoundingClientRect().top;
          if (elementTop < triggerBottom) el.classList.add("active");
        });
      }

      window.addEventListener("scroll", animateOnScroll);
      window.addEventListener("load", animateOnScroll);
    </script>
  </body>
</html>
